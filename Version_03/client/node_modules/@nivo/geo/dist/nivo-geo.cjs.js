"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("@nivo/core"),r=require("@nivo/tooltip"),o=require("prop-types"),i=require("@nivo/colors"),n=require("lodash/get"),a=require("lodash/isFunction"),u=require("d3-format"),l=require("d3-geo"),s=require("@nivo/legends"),d=require("react/jsx-runtime");function c(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var f=c(o),p=c(n),h=c(a);function g(){return g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},g.apply(this,arguments)}var v={azimuthalEqualArea:l.geoAzimuthalEqualArea,azimuthalEquidistant:l.geoAzimuthalEquidistant,gnomonic:l.geoGnomonic,orthographic:l.geoOrthographic,stereographic:l.geoStereographic,equalEarth:l.geoEqualEarth,equirectangular:l.geoEquirectangular,mercator:l.geoMercator,transverseMercator:l.geoTransverseMercator,naturalEarth1:l.geoNaturalEarth1},C=function(r){var o=r.width,n=r.height,a=r.projectionType,u=r.projectionScale,s=r.projectionTranslation,d=r.projectionRotation,c=r.fillColor,f=r.borderWidth,p=r.borderColor,h=e.useMemo((function(){return v[a]().scale(u).translate([o*s[0],n*s[1]]).rotate(d)}),[o,n,a,u,s[0],s[1],d[0],d[1],d[2]]),g=e.useMemo((function(){return l.geoPath(h)}),[h]),C=e.useMemo((function(){return l.geoGraticule()})),m=t.useTheme(),b=e.useMemo((function(){return"function"==typeof f?f:function(){return f}}),[f]),j=i.useInheritedColor(p,m),y=e.useMemo((function(){return"function"==typeof c?c:function(){return c}}),[c]);return{projection:h,path:g,graticule:C,getBorderWidth:b,getBorderColor:j,getFillColor:y}},m=function(r){var o=r.features,i=r.data,n=r.match,a=r.label,l=r.value,d=r.valueFormat,c=r.colors,f=r.unknownColor,v=r.domain,C=e.useMemo((function(){return h.default(n)?n:function(e,t){var r=p.default(e,n),o=p.default(t,n);return r&&r===o}}),[n]),m=e.useMemo((function(){return h.default(a)?a:function(e){return p.default(e,a)}}),[a]),b=e.useMemo((function(){return h.default(l)?l:function(e){return p.default(e,l)}}),[l]),j=e.useMemo((function(){return void 0===d?function(e){return e}:h.default(d)?d:u.format(d)}),[d]),y=e.useMemo((function(){return t.guessQuantizeColorScale(c).domain(v)}),[c,v]),R=e.useMemo((function(){return function(e){return void 0===e.value?f:y(e.value)}}),[y,f]),q=e.useMemo((function(){return o.map((function(e){var t=i.find((function(t){return C(e,t)})),r=b(t);if(t){var o=g({},e,{data:t,value:r,formattedValue:j(r)});return o.color=R(o),o.label=m(o),o}return e}))}),[o,i,C,b,j,R]),M=s.useQuantizeColorScaleLegendData({scale:y,valueFormat:j});return{colorScale:y,getFillColor:R,boundFeatures:q,valueFormatter:j,legendData:M}},b=e.memo((function(e){var t=e.feature;return void 0===t.data?null:d.jsx(r.BasicTooltip,{id:t.label,color:t.color,enableChip:!0,value:t.formattedValue})}));b.propTypes={feature:f.default.object.isRequired},b.displayName="ChoroplethTooltip";var j={features:f.default.arrayOf(f.default.shape({id:f.default.string.isRequired,type:f.default.oneOf(["Feature"]).isRequired,properties:f.default.object,geometry:f.default.object.isRequired})).isRequired,projectionType:f.default.oneOf(Object.keys(v)).isRequired,projectionScale:f.default.number.isRequired,projectionTranslation:f.default.arrayOf(f.default.number).isRequired,projectionRotation:f.default.arrayOf(f.default.number).isRequired,fillColor:f.default.oneOfType([f.default.string,f.default.func]).isRequired,borderWidth:f.default.oneOfType([f.default.number,f.default.func]).isRequired,borderColor:i.inheritedColorPropType.isRequired,enableGraticule:f.default.bool.isRequired,graticuleLineWidth:f.default.number.isRequired,graticuleLineColor:f.default.string.isRequired,isInteractive:f.default.bool.isRequired,onMouseEnter:f.default.func.isRequired,onMouseMove:f.default.func.isRequired,onMouseLeave:f.default.func.isRequired,onClick:f.default.func.isRequired,tooltip:f.default.any,layers:f.default.arrayOf(f.default.oneOfType([f.default.oneOf(["graticule","features"]),f.default.func])).isRequired},y=g({},j,{role:f.default.string.isRequired}),R=g({pixelRatio:f.default.number.isRequired},j),q={data:f.default.arrayOf(f.default.object).isRequired,match:f.default.oneOfType([f.default.string,f.default.func]).isRequired,label:f.default.oneOfType([f.default.string,f.default.func]).isRequired,value:f.default.oneOfType([f.default.string,f.default.func]).isRequired,valueFormat:f.default.oneOfType([f.default.string,f.default.func]),colors:t.quantizeColorScalePropType.isRequired,domain:f.default.arrayOf(f.default.number).isRequired,unknownColor:f.default.string.isRequired,layers:f.default.arrayOf(f.default.oneOfType([f.default.oneOf(["graticule","features","legends"]),f.default.func])).isRequired},M=g({},y,q,{role:f.default.string.isRequired}),T=g({},R,q),x={projectionType:"mercator",projectionScale:100,projectionTranslation:[.5,.5],projectionRotation:[0,0,0],enableGraticule:!1,graticuleLineWidth:.5,graticuleLineColor:"#999999",fillColor:"#dddddd",borderWidth:0,borderColor:"#000000",isInteractive:!0,onMouseEnter:function(){},onMouseLeave:function(){},onMouseMove:function(){},onClick:function(){},layers:["graticule","features"],legends:[],fill:[],defs:[]},k=g({},x,{role:"img"}),W=g({},x,{pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1}),w={match:"id",label:"id",value:"value",colors:"PuBuGn",unknownColor:"#999",tooltip:b,layers:["graticule","features","legends"]},F=g({},k,w,{role:"img"}),E=g({},W,w),S=e.memo((function(e){var t=e.path,r=e.graticule,o=e.lineWidth,i=e.lineColor;return d.jsx("path",{fill:"none",strokeWidth:o,stroke:i,d:t(r())})}));S.propTypes={path:f.default.func.isRequired,graticule:f.default.func.isRequired,lineWidth:f.default.number.isRequired,lineColor:f.default.string.isRequired},S.displayName="GeoGraticule";var O=e.memo((function(e){var t,r=e.feature,o=e.path,i=e.fillColor,n=e.borderWidth,a=e.borderColor,u=e.onClick,l=e.onMouseEnter,s=e.onMouseMove,c=e.onMouseLeave;return d.jsx("path",{fill:null!=(t=null==r?void 0:r.fill)?t:i,strokeWidth:n,stroke:a,strokeLinejoin:"bevel",d:o(r),onMouseEnter:function(e){return l(r,e)},onMouseMove:function(e){return s(r,e)},onMouseLeave:function(e){return c(r,e)},onClick:function(e){return u(r,e)}},r.id)}));O.propTypes={feature:f.default.shape({id:f.default.string.isRequired,type:f.default.oneOf(["Feature"]).isRequired,properties:f.default.object,geometry:f.default.object.isRequired}).isRequired,path:f.default.func.isRequired,fillColor:f.default.string.isRequired,borderWidth:f.default.number.isRequired,borderColor:f.default.string.isRequired,onMouseEnter:f.default.func.isRequired,onMouseMove:f.default.func.isRequired,onMouseLeave:f.default.func.isRequired,onClick:f.default.func.isRequired},O.displayName="GeoMapFeature";var L=e.memo((function(o){var i=o.width,n=o.height,a=o.margin,u=o.features,l=o.layers,s=o.projectionType,c=o.projectionScale,f=o.projectionTranslation,p=o.projectionRotation,h=o.fillColor,g=o.borderWidth,v=o.borderColor,m=o.enableGraticule,b=o.graticuleLineWidth,j=o.graticuleLineColor,y=o.isInteractive,R=o.onClick,q=o.tooltip,M=o.role,T=t.useDimensions(i,n,a),x=T.margin,k=T.outerWidth,W=T.outerHeight,w=C({width:i,height:n,projectionType:s,projectionScale:c,projectionTranslation:f,projectionRotation:p,fillColor:h,borderWidth:g,borderColor:v}),F=w.graticule,E=w.path,L=w.getFillColor,G=w.getBorderWidth,P=w.getBorderColor,B=t.useTheme(),D=r.useTooltip(),I=D.showTooltipFromEvent,N=D.hideTooltip,z=e.useCallback((function(e,t){return y&&R&&R(e,t)}),[y,R]),H=e.useCallback((function(e,t){return y&&q&&I(d.jsx(q,{feature:e}),t)}),[y,I,q]),A=e.useCallback((function(e,t){return y&&q&&I(d.jsx(q,{feature:e}),t)}),[y,I,q]),K=e.useCallback((function(){return y&&N()}),[y,N]);return d.jsx(t.SvgWrapper,{width:k,height:W,margin:x,theme:B,role:M,children:l.map((function(t,r){return"graticule"===t?!0!==m?null:d.jsx(S,{path:E,graticule:F,lineWidth:b,lineColor:j},"graticule"):"features"===t?d.jsx(e.Fragment,{children:u.map((function(e){return d.jsx(O,{feature:e,path:E,fillColor:L(e),borderWidth:G(e),borderColor:P(e),onMouseEnter:H,onMouseMove:A,onMouseLeave:K,onClick:z},e.id)}))},"features"):d.jsx(e.Fragment,{children:t(o)},r)}))})}));L.displayName="GeoMap",L.propTypes=y,L.defaultProps=k;var G=t.withContainer(L),P=function(e,r,o,i){var n=t.getRelativeCursor(r,e),a=n[0],u=n[1];return o.find((function(e){return l.geoContains(e,i.invert([a,u]))}))},B=e.memo((function(o){var i=o.width,n=o.height,a=o.margin,u=o.pixelRatio,l=o.features,s=o.layers,c=o.projectionType,f=o.projectionScale,p=o.projectionTranslation,h=o.projectionRotation,g=o.fillColor,v=o.borderWidth,m=o.borderColor,b=o.enableGraticule,j=o.graticuleLineWidth,y=o.graticuleLineColor,R=o.isInteractive,q=o.onClick,M=o.onMouseMove,T=o.tooltip,x=e.useRef(null),k=t.useTheme(),W=t.useDimensions(i,n,a),w=W.margin,F=W.outerWidth,E=W.outerHeight,S=C({width:i,height:n,projectionType:c,projectionScale:f,projectionTranslation:p,projectionRotation:h,fillColor:g,borderWidth:v,borderColor:m}),O=S.projection,L=S.graticule,G=S.path,B=S.getFillColor,D=S.getBorderWidth,I=S.getBorderColor;e.useEffect((function(){if(x){x.current.width=F*u,x.current.height=E*u;var e=x.current.getContext("2d");e.scale(u,u),e.fillStyle=k.background,e.fillRect(0,0,F,E),e.translate(w.left,w.top),G.context(e),s.forEach((function(t){"graticule"===t?!0===b&&(e.lineWidth=j,e.strokeStyle=y,e.beginPath(),G(L()),e.stroke()):"features"===t?l.forEach((function(t){e.beginPath(),G(t),e.fillStyle=B(t),e.fill();var r=D(t);r>0&&(e.strokeStyle=I(t),e.lineWidth=r,e.stroke())})):t(e,o)}))}}),[x,F,E,w,u,k,G,L,B,D,I,l,s]);var N=r.useTooltip(),z=N.showTooltipFromEvent,H=N.hideTooltip,A=e.useCallback((function(e){if(R&&T){var t=P(e,x.current,l,O);t?z(d.jsx(T,{feature:t}),e):H(),M&&M(t||null,e)}}),[z,H,R,T,x,l,O]),K=e.useCallback((function(){return R&&H()}),[R,H]),Q=e.useCallback((function(e){if(R&&q){var t=P(e,x.current,l,O);t&&q(t,e)}}),[R,x,l,O,q]);return d.jsx("canvas",{ref:x,width:F*u,height:E*u,style:{width:F,height:E,cursor:R?"auto":"normal"},onMouseMove:A,onMouseLeave:K,onClick:Q})}));B.displatName="GeoMapCanvas",B.propTypes=R,B.defaultProps=W;var D=t.withContainer(B),I=e.memo((function(o){var i=o.width,n=o.height,a=o.margin,u=o.features,l=o.data,c=o.match,f=o.label,p=o.value,h=o.valueFormat,v=o.projectionType,b=o.projectionScale,j=o.projectionTranslation,y=o.projectionRotation,R=o.colors,q=o.domain,M=o.unknownColor,T=o.borderWidth,x=o.borderColor,k=o.enableGraticule,W=o.graticuleLineWidth,w=o.graticuleLineColor,E=o.layers,L=o.legends,G=o.isInteractive,P=o.onClick,B=o.tooltip,D=o.role,I=o.defs,N=void 0===I?F.defs:I,z=o.fill,H=void 0===z?F.fill:z,A=t.useDimensions(i,n,a),K=A.margin,Q=A.outerWidth,V=A.outerHeight,_=C({width:i,height:n,projectionType:v,projectionScale:b,projectionTranslation:j,projectionRotation:y,fillColor:function(){},borderWidth:T,borderColor:x}),J=_.graticule,U=_.path,X=_.getBorderWidth,Y=_.getBorderColor,Z=m({features:u,data:l,match:c,label:f,value:p,valueFormat:h,colors:R,unknownColor:M,domain:q}),$=Z.getFillColor,ee=Z.boundFeatures,te=Z.legendData,re=t.useTheme(),oe=t.bindDefs(N,ee,H,{dataKey:"data",targetKey:"fill"}),ie=r.useTooltip(),ne=ie.showTooltipFromEvent,ae=ie.hideTooltip,ue=e.useCallback((function(e,t){return G&&P&&P(e,t)}),[G,P]),le=e.useCallback((function(e,t){return G&&B&&ne(d.jsx(B,{feature:e}),t)}),[G,ne,B]),se=e.useCallback((function(e,t){return G&&B&&ne(d.jsx(B,{feature:e}),t)}),[G,ne,B]),de=e.useCallback((function(){return G&&ae()}),[G,ae]);return d.jsx(t.SvgWrapper,{width:Q,height:V,margin:K,theme:re,defs:oe,role:D,children:E.map((function(t,r){return"graticule"===t?!0!==k?null:d.jsx(S,{path:U,graticule:J,lineWidth:W,lineColor:w},"graticule"):"features"===t?d.jsx(e.Fragment,{children:ee.map((function(e){return d.jsx(O,{feature:e,path:U,fillColor:$(e),borderWidth:X(e),borderColor:Y(e),onMouseEnter:le,onMouseMove:se,onMouseLeave:de,onClick:ue},e.id)}))},"features"):"legends"===t?L.map((function(e,t){return d.jsx(s.BoxLegendSvg,g({containerWidth:i,containerHeight:n,data:te},e),t)})):d.jsx(e.Fragment,{children:t({})},r)}))})}));I.displayName="Choropleth",I.propTypes=M,I.defaultProps=F;var N=t.withContainer(I),z=function(e,r,o,i){var n=t.getRelativeCursor(r,e),a=n[0],u=n[1];return o.find((function(e){return l.geoContains(e,i.invert([a,u]))}))},H=e.memo((function(o){var i=o.width,n=o.height,a=o.margin,u=o.pixelRatio,l=o.features,c=o.data,f=o.match,p=o.label,h=o.value,v=o.valueFormat,b=o.projectionType,j=o.projectionScale,y=o.projectionTranslation,R=o.projectionRotation,q=o.colors,M=o.domain,T=o.unknownColor,x=o.borderWidth,k=o.borderColor,W=o.enableGraticule,w=o.graticuleLineWidth,F=o.graticuleLineColor,E=o.layers,S=o.legends,O=o.isInteractive,L=o.onClick,G=o.onMouseMove,P=o.tooltip,B=e.useRef(null),D=t.useTheme(),I=t.useDimensions(i,n,a),N=I.margin,H=I.outerWidth,A=I.outerHeight,K=C({width:i,height:n,projectionType:b,projectionScale:j,projectionTranslation:y,projectionRotation:R,fillColor:function(){},borderWidth:x,borderColor:k}),Q=K.projection,V=K.graticule,_=K.path,J=K.getBorderWidth,U=K.getBorderColor,X=m({features:l,data:c,match:f,label:p,value:h,valueFormat:v,colors:q,unknownColor:T,domain:M}),Y=X.getFillColor,Z=X.boundFeatures,$=X.legendData;e.useEffect((function(){if(B){B.current.width=H*u,B.current.height=A*u;var e=B.current.getContext("2d");e.scale(u,u),e.fillStyle=D.background,e.fillRect(0,0,H,A),e.translate(N.left,N.top),_.context(e),E.forEach((function(t){"graticule"===t?!0===W&&(e.lineWidth=w,e.strokeStyle=F,e.beginPath(),_(V()),e.stroke()):"features"===t?Z.forEach((function(t){e.beginPath(),_(t),e.fillStyle=Y(t),e.fill();var r=J(t);r>0&&(e.strokeStyle=U(t),e.lineWidth=r,e.stroke())})):"legends"===t&&S.forEach((function(t){s.renderLegendToCanvas(e,g({},t,{data:$,containerWidth:i,containerHeight:n,theme:D}))}))}))}}),[B,H,A,N,u,D,_,V,Y,J,U,Z,S,E]);var ee=r.useTooltip(),te=ee.showTooltipFromEvent,re=ee.hideTooltip,oe=e.useCallback((function(e){if(O&&P){var t=z(e,B.current,Z,Q);t?te(d.jsx(P,{feature:t}),e):re(),G&&G(t||null,e)}}),[te,re,O,P,B,Z,Q]),ie=e.useCallback((function(){return O&&re()}),[O,re]),ne=e.useCallback((function(e){if(O&&L){var t=z(e,B.current,Z,Q);t&&L(t,e)}}),[O,B,Z,Q,L]);return d.jsx("canvas",{ref:B,width:H*u,height:A*u,style:{width:H,height:A,cursor:O?"auto":"normal"},onMouseMove:oe,onMouseLeave:ie,onClick:ne})}));H.displayName="ChoroplethCanvas",H.propTypes=T,H.defaultProps=E;var A=t.withContainer(H);exports.Choropleth=N,exports.ChoroplethCanvas=A,exports.ChoroplethCanvasDefaultProps=E,exports.ChoroplethCanvasPropTypes=T,exports.ChoroplethDefaultProps=F,exports.ChoroplethPropTypes=M,exports.GeoMap=G,exports.GeoMapCanvas=D,exports.GeoMapCanvasDefaultProps=W,exports.GeoMapCanvasPropTypes=R,exports.GeoMapDefaultProps=k,exports.GeoMapPropTypes=y,exports.ResponsiveChoropleth=function(e){return d.jsx(t.ResponsiveWrapper,{children:function(t){var r=t.width,o=t.height;return d.jsx(N,g({width:r,height:o},e))}})},exports.ResponsiveChoroplethCanvas=function(e){return d.jsx(t.ResponsiveWrapper,{children:function(t){var r=t.width,o=t.height;return d.jsx(A,g({width:r,height:o},e))}})},exports.ResponsiveGeoMap=function(e){return d.jsx(t.ResponsiveWrapper,{children:function(t){var r=t.width,o=t.height;return d.jsx(G,g({width:r,height:o},e))}})},exports.ResponsiveGeoMapCanvas=function(e){return d.jsx(t.ResponsiveWrapper,{children:function(t){var r=t.width,o=t.height;return d.jsx(D,g({width:r,height:o},e))}})},exports.projectionById=v,exports.useChoropleth=m,exports.useGeoMap=C;
//# sourceMappingURL=nivo-geo.cjs.js.map
