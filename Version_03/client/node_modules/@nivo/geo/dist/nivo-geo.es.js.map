{"version":3,"file":"nivo-geo.es.js","sources":["../src/hooks.js","../src/ChoroplethTooltip.js","../src/props.js","../src/GeoGraticule.js","../src/GeoMapFeature.js","../src/GeoMap.js","../src/ResponsiveGeoMap.js","../src/GeoMapCanvas.js","../src/ResponsiveGeoMapCanvas.js","../src/Choropleth.js","../src/ResponsiveChoropleth.js","../src/ChoroplethCanvas.js","../src/ResponsiveChoroplethCanvas.js"],"sourcesContent":["/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nimport { useMemo } from 'react'\nimport { isFunction, get } from 'lodash'\nimport { format } from 'd3-format'\nimport {\n    geoPath,\n    geoAzimuthalEqualArea,\n    geoAzimuthalEquidistant,\n    geoGnomonic,\n    geoOrthographic,\n    geoStereographic,\n    geoEqualEarth,\n    geoEquirectangular,\n    geoMercator,\n    geoTransverseMercator,\n    geoNaturalEarth1,\n    geoGraticule,\n} from 'd3-geo'\nimport { guessQuantizeColorScale, useTheme } from '@nivo/core'\nimport { useInheritedColor } from '@nivo/colors'\nimport { useQuantizeColorScaleLegendData } from '@nivo/legends'\n\nexport const projectionById = {\n    azimuthalEqualArea: geoAzimuthalEqualArea,\n    azimuthalEquidistant: geoAzimuthalEquidistant,\n    gnomonic: geoGnomonic,\n    orthographic: geoOrthographic,\n    stereographic: geoStereographic,\n    equalEarth: geoEqualEarth,\n    equirectangular: geoEquirectangular,\n    mercator: geoMercator,\n    transverseMercator: geoTransverseMercator,\n    naturalEarth1: geoNaturalEarth1,\n}\n\nexport const useGeoMap = ({\n    width,\n    height,\n    projectionType,\n    projectionScale,\n    projectionTranslation,\n    projectionRotation,\n    fillColor,\n    borderWidth,\n    borderColor,\n}) => {\n    const projection = useMemo(() => {\n        return projectionById[projectionType]()\n            .scale(projectionScale)\n            .translate([width * projectionTranslation[0], height * projectionTranslation[1]])\n            .rotate(projectionRotation)\n    }, [\n        width,\n        height,\n        projectionType,\n        projectionScale,\n        projectionTranslation[0],\n        projectionTranslation[1],\n        projectionRotation[0],\n        projectionRotation[1],\n        projectionRotation[2],\n    ])\n    const path = useMemo(() => geoPath(projection), [projection])\n    const graticule = useMemo(() => geoGraticule())\n\n    const theme = useTheme()\n    const getBorderWidth = useMemo(\n        () => (typeof borderWidth === 'function' ? borderWidth : () => borderWidth),\n        [borderWidth]\n    )\n    const getBorderColor = useInheritedColor(borderColor, theme)\n    const getFillColor = useMemo(\n        () => (typeof fillColor === 'function' ? fillColor : () => fillColor),\n        [fillColor]\n    )\n\n    return {\n        projection,\n        path,\n        graticule,\n        getBorderWidth,\n        getBorderColor,\n        getFillColor,\n    }\n}\n\nexport const useChoropleth = ({\n    features,\n    data,\n    match,\n    label,\n    value,\n    valueFormat,\n    colors,\n    unknownColor,\n    domain,\n}) => {\n    const findMatchingDatum = useMemo(() => {\n        if (isFunction(match)) return match\n        return (feature, datum) => {\n            const featureKey = get(feature, match)\n            const datumKey = get(datum, match)\n\n            return featureKey && featureKey === datumKey\n        }\n    }, [match])\n    const getLabel = useMemo(\n        () => (isFunction(label) ? label : datum => get(datum, label)),\n        [label]\n    )\n    const getValue = useMemo(\n        () => (isFunction(value) ? value : datum => get(datum, value)),\n        [value]\n    )\n    const valueFormatter = useMemo(() => {\n        if (valueFormat === undefined) return d => d\n        if (isFunction(valueFormat)) return valueFormat\n        return format(valueFormat)\n    }, [valueFormat])\n\n    const colorScale = useMemo(\n        () => guessQuantizeColorScale(colors).domain(domain),\n        [colors, domain]\n    )\n    const getFillColor = useMemo(() => {\n        return feature => {\n            if (feature.value === undefined) return unknownColor\n            return colorScale(feature.value)\n        }\n    }, [colorScale, unknownColor])\n\n    const boundFeatures = useMemo(\n        () =>\n            features.map(feature => {\n                const datum = data.find(datum => findMatchingDatum(feature, datum))\n                const datumValue = getValue(datum)\n\n                if (datum) {\n                    const featureWithData = {\n                        ...feature,\n                        data: datum,\n                        value: datumValue,\n                        formattedValue: valueFormatter(datumValue),\n                    }\n                    featureWithData.color = getFillColor(featureWithData)\n                    featureWithData.label = getLabel(featureWithData)\n\n                    return featureWithData\n                }\n\n                return feature\n            }),\n        [features, data, findMatchingDatum, getValue, valueFormatter, getFillColor]\n    )\n\n    const legendData = useQuantizeColorScaleLegendData({\n        scale: colorScale,\n        valueFormat: valueFormatter,\n    })\n\n    return {\n        colorScale,\n        getFillColor,\n        boundFeatures,\n        valueFormatter,\n        legendData,\n    }\n}\n","/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nimport { memo } from 'react'\nimport PropTypes from 'prop-types'\nimport { BasicTooltip } from '@nivo/tooltip'\n\nconst ChoroplethTooltip = memo(({ feature }) => {\n    if (feature.data === undefined) return null\n\n    return (\n        <BasicTooltip\n            id={feature.label}\n            color={feature.color}\n            enableChip={true}\n            value={feature.formattedValue}\n        />\n    )\n})\n\nChoroplethTooltip.propTypes = {\n    feature: PropTypes.object.isRequired,\n}\n\nChoroplethTooltip.displayName = 'ChoroplethTooltip'\n\nexport default ChoroplethTooltip\n","/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nimport PropTypes from 'prop-types'\nimport { quantizeColorScalePropType } from '@nivo/core'\nimport { inheritedColorPropType } from '@nivo/colors'\nimport { projectionById } from './hooks'\nimport ChoroplethTooltip from './ChoroplethTooltip'\n\nconst commonPropTypes = {\n    features: PropTypes.arrayOf(\n        PropTypes.shape({\n            id: PropTypes.string.isRequired,\n            type: PropTypes.oneOf(['Feature']).isRequired,\n            properties: PropTypes.object,\n            geometry: PropTypes.object.isRequired,\n        })\n    ).isRequired,\n\n    projectionType: PropTypes.oneOf(Object.keys(projectionById)).isRequired,\n    projectionScale: PropTypes.number.isRequired,\n    projectionTranslation: PropTypes.arrayOf(PropTypes.number).isRequired,\n    projectionRotation: PropTypes.arrayOf(PropTypes.number).isRequired,\n\n    fillColor: PropTypes.oneOfType([PropTypes.string, PropTypes.func]).isRequired,\n    borderWidth: PropTypes.oneOfType([PropTypes.number, PropTypes.func]).isRequired,\n    borderColor: inheritedColorPropType.isRequired,\n\n    enableGraticule: PropTypes.bool.isRequired,\n    graticuleLineWidth: PropTypes.number.isRequired,\n    graticuleLineColor: PropTypes.string.isRequired,\n\n    isInteractive: PropTypes.bool.isRequired,\n    onMouseEnter: PropTypes.func.isRequired,\n    onMouseMove: PropTypes.func.isRequired,\n    onMouseLeave: PropTypes.func.isRequired,\n    onClick: PropTypes.func.isRequired,\n    tooltip: PropTypes.any,\n\n    layers: PropTypes.arrayOf(\n        PropTypes.oneOfType([PropTypes.oneOf(['graticule', 'features']), PropTypes.func])\n    ).isRequired,\n}\n\nexport const GeoMapPropTypes = {\n    ...commonPropTypes,\n    role: PropTypes.string.isRequired,\n}\n\nexport const GeoMapCanvasPropTypes = {\n    pixelRatio: PropTypes.number.isRequired,\n    ...commonPropTypes,\n}\n\nconst commonChoroplethPropTypes = {\n    data: PropTypes.arrayOf(PropTypes.object).isRequired,\n    match: PropTypes.oneOfType([PropTypes.string, PropTypes.func]).isRequired,\n    label: PropTypes.oneOfType([PropTypes.string, PropTypes.func]).isRequired,\n    value: PropTypes.oneOfType([PropTypes.string, PropTypes.func]).isRequired,\n    valueFormat: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n    colors: quantizeColorScalePropType.isRequired,\n    domain: PropTypes.arrayOf(PropTypes.number).isRequired,\n    unknownColor: PropTypes.string.isRequired,\n    layers: PropTypes.arrayOf(\n        PropTypes.oneOfType([PropTypes.oneOf(['graticule', 'features', 'legends']), PropTypes.func])\n    ).isRequired,\n}\n\nexport const ChoroplethPropTypes = {\n    ...GeoMapPropTypes,\n    ...commonChoroplethPropTypes,\n    role: PropTypes.string.isRequired,\n}\n\nexport const ChoroplethCanvasPropTypes = {\n    ...GeoMapCanvasPropTypes,\n    ...commonChoroplethPropTypes,\n}\n\nconst commonDefaultProps = {\n    projectionType: 'mercator',\n    projectionScale: 100,\n    projectionTranslation: [0.5, 0.5],\n    projectionRotation: [0, 0, 0],\n\n    enableGraticule: false,\n    graticuleLineWidth: 0.5,\n    graticuleLineColor: '#999999',\n\n    fillColor: '#dddddd',\n    borderWidth: 0,\n    borderColor: '#000000',\n\n    isInteractive: true,\n    onMouseEnter: () => {},\n    onMouseLeave: () => {},\n    onMouseMove: () => {},\n    onClick: () => {},\n\n    layers: ['graticule', 'features'],\n    legends: [],\n\n    fill: [],\n    defs: [],\n}\n\nexport const GeoMapDefaultProps = {\n    ...commonDefaultProps,\n    role: 'img',\n}\n\nexport const GeoMapCanvasDefaultProps = {\n    ...commonDefaultProps,\n    pixelRatio: typeof window !== 'undefined' ? window.devicePixelRatio || 1 : 1,\n}\n\nconst commonChoroplethDefaultProps = {\n    match: 'id',\n    label: 'id',\n    value: 'value',\n    colors: 'PuBuGn',\n    unknownColor: '#999',\n    tooltip: ChoroplethTooltip,\n    layers: ['graticule', 'features', 'legends'],\n}\n\nexport const ChoroplethDefaultProps = {\n    ...GeoMapDefaultProps,\n    ...commonChoroplethDefaultProps,\n    role: 'img',\n}\n\nexport const ChoroplethCanvasDefaultProps = {\n    ...GeoMapCanvasDefaultProps,\n    ...commonChoroplethDefaultProps,\n}\n","/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nimport { memo } from 'react'\nimport PropTypes from 'prop-types'\n\nconst GeoGraticule = memo(({ path, graticule, lineWidth, lineColor }) => {\n    return <path fill=\"none\" strokeWidth={lineWidth} stroke={lineColor} d={path(graticule())} />\n})\n\nGeoGraticule.propTypes = {\n    path: PropTypes.func.isRequired,\n    graticule: PropTypes.func.isRequired,\n    lineWidth: PropTypes.number.isRequired,\n    lineColor: PropTypes.string.isRequired,\n}\n\nGeoGraticule.displayName = 'GeoGraticule'\n\nexport default GeoGraticule\n","/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nimport { memo } from 'react'\nimport PropTypes from 'prop-types'\n\nconst GeoMapFeature = memo(\n    ({\n        feature,\n        path,\n        fillColor,\n        borderWidth,\n        borderColor,\n        onClick,\n        onMouseEnter,\n        onMouseMove,\n        onMouseLeave,\n    }) => {\n        return (\n            <path\n                key={feature.id}\n                fill={feature?.fill ?? fillColor}\n                strokeWidth={borderWidth}\n                stroke={borderColor}\n                strokeLinejoin=\"bevel\"\n                d={path(feature)}\n                onMouseEnter={event => onMouseEnter(feature, event)}\n                onMouseMove={event => onMouseMove(feature, event)}\n                onMouseLeave={event => onMouseLeave(feature, event)}\n                onClick={event => onClick(feature, event)}\n            />\n        )\n    }\n)\n\nGeoMapFeature.propTypes = {\n    feature: PropTypes.shape({\n        id: PropTypes.string.isRequired,\n        type: PropTypes.oneOf(['Feature']).isRequired,\n        properties: PropTypes.object,\n        geometry: PropTypes.object.isRequired,\n    }).isRequired,\n    path: PropTypes.func.isRequired,\n\n    fillColor: PropTypes.string.isRequired,\n    borderWidth: PropTypes.number.isRequired,\n    borderColor: PropTypes.string.isRequired,\n\n    onMouseEnter: PropTypes.func.isRequired,\n    onMouseMove: PropTypes.func.isRequired,\n    onMouseLeave: PropTypes.func.isRequired,\n    onClick: PropTypes.func.isRequired,\n}\n\nGeoMapFeature.displayName = 'GeoMapFeature'\n\nexport default GeoMapFeature\n","/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nimport { Fragment, useCallback, memo } from 'react'\nimport { SvgWrapper, withContainer, useDimensions, useTheme } from '@nivo/core'\nimport { useTooltip } from '@nivo/tooltip'\nimport { GeoMapPropTypes, GeoMapDefaultProps } from './props'\nimport GeoGraticule from './GeoGraticule'\nimport GeoMapFeature from './GeoMapFeature'\nimport { useGeoMap } from './hooks'\n\nconst GeoMap = memo(props => {\n    const {\n        width,\n        height,\n        margin: partialMargin,\n        features,\n        layers,\n        projectionType,\n        projectionScale,\n        projectionTranslation,\n        projectionRotation,\n        fillColor,\n        borderWidth,\n        borderColor,\n        enableGraticule,\n        graticuleLineWidth,\n        graticuleLineColor,\n        isInteractive,\n        onClick,\n        tooltip: Tooltip,\n        role,\n    } = props\n    const { margin, outerWidth, outerHeight } = useDimensions(width, height, partialMargin)\n    const { graticule, path, getFillColor, getBorderWidth, getBorderColor } = useGeoMap({\n        width,\n        height,\n        projectionType,\n        projectionScale,\n        projectionTranslation,\n        projectionRotation,\n        fillColor,\n        borderWidth,\n        borderColor,\n    })\n\n    const theme = useTheme()\n\n    const { showTooltipFromEvent, hideTooltip } = useTooltip()\n    const handleClick = useCallback(\n        (feature, event) => isInteractive && onClick && onClick(feature, event),\n        [isInteractive, onClick]\n    )\n    const handleMouseEnter = useCallback(\n        (feature, event) =>\n            isInteractive && Tooltip && showTooltipFromEvent(<Tooltip feature={feature} />, event),\n        [isInteractive, showTooltipFromEvent, Tooltip]\n    )\n    const handleMouseMove = useCallback(\n        (feature, event) =>\n            isInteractive && Tooltip && showTooltipFromEvent(<Tooltip feature={feature} />, event),\n        [isInteractive, showTooltipFromEvent, Tooltip]\n    )\n    const handleMouseLeave = useCallback(\n        () => isInteractive && hideTooltip(),\n        [isInteractive, hideTooltip]\n    )\n\n    return (\n        <SvgWrapper\n            width={outerWidth}\n            height={outerHeight}\n            margin={margin}\n            theme={theme}\n            role={role}\n        >\n            {layers.map((layer, i) => {\n                if (layer === 'graticule') {\n                    if (enableGraticule !== true) return null\n\n                    return (\n                        <GeoGraticule\n                            key=\"graticule\"\n                            path={path}\n                            graticule={graticule}\n                            lineWidth={graticuleLineWidth}\n                            lineColor={graticuleLineColor}\n                        />\n                    )\n                }\n                if (layer === 'features') {\n                    return (\n                        <Fragment key=\"features\">\n                            {features.map(feature => (\n                                <GeoMapFeature\n                                    key={feature.id}\n                                    feature={feature}\n                                    path={path}\n                                    fillColor={getFillColor(feature)}\n                                    borderWidth={getBorderWidth(feature)}\n                                    borderColor={getBorderColor(feature)}\n                                    onMouseEnter={handleMouseEnter}\n                                    onMouseMove={handleMouseMove}\n                                    onMouseLeave={handleMouseLeave}\n                                    onClick={handleClick}\n                                />\n                            ))}\n                        </Fragment>\n                    )\n                }\n\n                return <Fragment key={i}>{layer(props)}</Fragment>\n            })}\n        </SvgWrapper>\n    )\n})\n\nGeoMap.displayName = 'GeoMap'\nGeoMap.propTypes = GeoMapPropTypes\nGeoMap.defaultProps = GeoMapDefaultProps\n\nexport default withContainer(GeoMap)\n","/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nimport { ResponsiveWrapper } from '@nivo/core'\nimport GeoMap from './GeoMap'\n\nconst ResponsiveGeoMap = props => (\n    <ResponsiveWrapper>\n        {({ width, height }) => <GeoMap width={width} height={height} {...props} />}\n    </ResponsiveWrapper>\n)\n\nexport default ResponsiveGeoMap\n","/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nimport { memo, useRef, useEffect, useCallback } from 'react'\nimport { geoContains } from 'd3-geo'\nimport { getRelativeCursor, withContainer, useDimensions, useTheme } from '@nivo/core'\nimport { useTooltip } from '@nivo/tooltip'\nimport { GeoMapCanvasDefaultProps, GeoMapCanvasPropTypes } from './props'\nimport { useGeoMap } from './hooks'\n\nconst getFeatureFromMouseEvent = (event, el, features, projection) => {\n    const [x, y] = getRelativeCursor(el, event)\n\n    return features.find(f => geoContains(f, projection.invert([x, y])))\n}\n\nconst GeoMapCanvas = memo(props => {\n    const {\n        width,\n        height,\n        margin: partialMargin,\n        pixelRatio,\n        features,\n        layers,\n\n        projectionType,\n        projectionScale,\n        projectionTranslation,\n        projectionRotation,\n\n        fillColor,\n        borderWidth,\n        borderColor,\n\n        enableGraticule,\n        graticuleLineWidth,\n        graticuleLineColor,\n\n        isInteractive,\n        onClick,\n        onMouseMove,\n        tooltip: Tooltip,\n    } = props\n\n    const canvasEl = useRef(null)\n    const theme = useTheme()\n    const { margin, outerWidth, outerHeight } = useDimensions(width, height, partialMargin)\n    const { projection, graticule, path, getFillColor, getBorderWidth, getBorderColor } = useGeoMap(\n        {\n            width,\n            height,\n            projectionType,\n            projectionScale,\n            projectionTranslation,\n            projectionRotation,\n            fillColor,\n            borderWidth,\n            borderColor,\n        }\n    )\n\n    useEffect(() => {\n        if (!canvasEl) return\n\n        canvasEl.current.width = outerWidth * pixelRatio\n        canvasEl.current.height = outerHeight * pixelRatio\n\n        const ctx = canvasEl.current.getContext('2d')\n\n        ctx.scale(pixelRatio, pixelRatio)\n\n        ctx.fillStyle = theme.background\n        ctx.fillRect(0, 0, outerWidth, outerHeight)\n        ctx.translate(margin.left, margin.top)\n\n        path.context(ctx)\n\n        layers.forEach(layer => {\n            if (layer === 'graticule') {\n                if (enableGraticule === true) {\n                    ctx.lineWidth = graticuleLineWidth\n                    ctx.strokeStyle = graticuleLineColor\n                    ctx.beginPath()\n                    path(graticule())\n                    ctx.stroke()\n                }\n            } else if (layer === 'features') {\n                features.forEach(feature => {\n                    ctx.beginPath()\n                    path(feature)\n                    ctx.fillStyle = getFillColor(feature)\n                    ctx.fill()\n\n                    const borderWidth = getBorderWidth(feature)\n                    if (borderWidth > 0) {\n                        ctx.strokeStyle = getBorderColor(feature)\n                        ctx.lineWidth = borderWidth\n                        ctx.stroke()\n                    }\n                })\n            } else {\n                layer(ctx, props)\n            }\n        })\n    }, [\n        canvasEl,\n        outerWidth,\n        outerHeight,\n        margin,\n        pixelRatio,\n        theme,\n        path,\n        graticule,\n        getFillColor,\n        getBorderWidth,\n        getBorderColor,\n        features,\n        layers,\n    ])\n\n    const { showTooltipFromEvent, hideTooltip } = useTooltip()\n    const handleMouseMove = useCallback(\n        event => {\n            if (!isInteractive || !Tooltip) return\n\n            const feature = getFeatureFromMouseEvent(event, canvasEl.current, features, projection)\n            if (feature) {\n                showTooltipFromEvent(<Tooltip feature={feature} />, event)\n            } else {\n                hideTooltip()\n            }\n            onMouseMove && onMouseMove(feature || null, event)\n        },\n        [showTooltipFromEvent, hideTooltip, isInteractive, Tooltip, canvasEl, features, projection]\n    )\n    const handleMouseLeave = useCallback(\n        () => isInteractive && hideTooltip(),\n        [isInteractive, hideTooltip]\n    )\n    const handleClick = useCallback(\n        event => {\n            if (!isInteractive || !onClick) return\n\n            const feature = getFeatureFromMouseEvent(event, canvasEl.current, features, projection)\n            if (feature) {\n                onClick(feature, event)\n            }\n        },\n        [isInteractive, canvasEl, features, projection, onClick]\n    )\n\n    return (\n        <canvas\n            ref={canvasEl}\n            width={outerWidth * pixelRatio}\n            height={outerHeight * pixelRatio}\n            style={{\n                width: outerWidth,\n                height: outerHeight,\n                cursor: isInteractive ? 'auto' : 'normal',\n            }}\n            onMouseMove={handleMouseMove}\n            onMouseLeave={handleMouseLeave}\n            onClick={handleClick}\n        />\n    )\n})\n\nGeoMapCanvas.displatName = 'GeoMapCanvas'\nGeoMapCanvas.propTypes = GeoMapCanvasPropTypes\nGeoMapCanvas.defaultProps = GeoMapCanvasDefaultProps\n\nexport default withContainer(GeoMapCanvas)\n","/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nimport { ResponsiveWrapper } from '@nivo/core'\nimport GeoMapCanvas from './GeoMapCanvas'\n\nconst ResponsiveGeoMapCanvas = props => (\n    <ResponsiveWrapper>\n        {({ width, height }) => <GeoMapCanvas width={width} height={height} {...props} />}\n    </ResponsiveWrapper>\n)\n\nexport default ResponsiveGeoMapCanvas\n","/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nimport { memo, Fragment, useCallback } from 'react'\nimport { SvgWrapper, withContainer, useDimensions, useTheme, bindDefs } from '@nivo/core'\nimport { BoxLegendSvg } from '@nivo/legends'\nimport { useTooltip } from '@nivo/tooltip'\nimport { ChoroplethPropTypes, ChoroplethDefaultProps } from './props'\nimport GeoGraticule from './GeoGraticule'\nimport GeoMapFeature from './GeoMapFeature'\nimport { useGeoMap, useChoropleth } from './hooks'\n\nconst Choropleth = memo(\n    ({\n        width,\n        height,\n        margin: partialMargin,\n        features,\n        data,\n        match,\n        label,\n        value,\n        valueFormat,\n        projectionType,\n        projectionScale,\n        projectionTranslation,\n        projectionRotation,\n        colors,\n        domain,\n        unknownColor,\n        borderWidth,\n        borderColor,\n        enableGraticule,\n        graticuleLineWidth,\n        graticuleLineColor,\n        layers,\n        legends,\n        isInteractive,\n        onClick,\n        tooltip: Tooltip,\n        role,\n        defs = ChoroplethDefaultProps.defs,\n        fill = ChoroplethDefaultProps.fill,\n    }) => {\n        const { margin, outerWidth, outerHeight } = useDimensions(width, height, partialMargin)\n        const { graticule, path, getBorderWidth, getBorderColor } = useGeoMap({\n            width,\n            height,\n            projectionType,\n            projectionScale,\n            projectionTranslation,\n            projectionRotation,\n            fillColor: () => {},\n            borderWidth,\n            borderColor,\n        })\n        const { getFillColor, boundFeatures, legendData } = useChoropleth({\n            features,\n            data,\n            match,\n            label,\n            value,\n            valueFormat,\n            colors,\n            unknownColor,\n            domain,\n        })\n\n        const theme = useTheme()\n\n        const boundDefs = bindDefs(defs, boundFeatures, fill, {\n            dataKey: 'data',\n            targetKey: 'fill',\n        })\n\n        const { showTooltipFromEvent, hideTooltip } = useTooltip()\n        const handleClick = useCallback(\n            (feature, event) => isInteractive && onClick && onClick(feature, event),\n            [isInteractive, onClick]\n        )\n        const handleMouseEnter = useCallback(\n            (feature, event) =>\n                isInteractive &&\n                Tooltip &&\n                showTooltipFromEvent(<Tooltip feature={feature} />, event),\n            [isInteractive, showTooltipFromEvent, Tooltip]\n        )\n        const handleMouseMove = useCallback(\n            (feature, event) =>\n                isInteractive &&\n                Tooltip &&\n                showTooltipFromEvent(<Tooltip feature={feature} />, event),\n            [isInteractive, showTooltipFromEvent, Tooltip]\n        )\n        const handleMouseLeave = useCallback(\n            () => isInteractive && hideTooltip(),\n            [isInteractive, hideTooltip]\n        )\n\n        return (\n            <SvgWrapper\n                width={outerWidth}\n                height={outerHeight}\n                margin={margin}\n                theme={theme}\n                defs={boundDefs}\n                role={role}\n            >\n                {layers.map((layer, i) => {\n                    if (layer === 'graticule') {\n                        if (enableGraticule !== true) return null\n\n                        return (\n                            <GeoGraticule\n                                key=\"graticule\"\n                                path={path}\n                                graticule={graticule}\n                                lineWidth={graticuleLineWidth}\n                                lineColor={graticuleLineColor}\n                            />\n                        )\n                    }\n                    if (layer === 'features') {\n                        return (\n                            <Fragment key=\"features\">\n                                {boundFeatures.map(feature => (\n                                    <GeoMapFeature\n                                        key={feature.id}\n                                        feature={feature}\n                                        path={path}\n                                        fillColor={getFillColor(feature)}\n                                        borderWidth={getBorderWidth(feature)}\n                                        borderColor={getBorderColor(feature)}\n                                        onMouseEnter={handleMouseEnter}\n                                        onMouseMove={handleMouseMove}\n                                        onMouseLeave={handleMouseLeave}\n                                        onClick={handleClick}\n                                    />\n                                ))}\n                            </Fragment>\n                        )\n                    }\n                    if (layer === 'legends') {\n                        return legends.map((legend, i) => {\n                            return (\n                                <BoxLegendSvg\n                                    key={i}\n                                    containerWidth={width}\n                                    containerHeight={height}\n                                    data={legendData}\n                                    {...legend}\n                                />\n                            )\n                        })\n                    }\n\n                    return <Fragment key={i}>{layer({})}</Fragment>\n                })}\n            </SvgWrapper>\n        )\n    }\n)\n\nChoropleth.displayName = 'Choropleth'\nChoropleth.propTypes = ChoroplethPropTypes\nChoropleth.defaultProps = ChoroplethDefaultProps\n\nexport default withContainer(Choropleth)\n","/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nimport { ResponsiveWrapper } from '@nivo/core'\nimport Choropleth from './Choropleth'\n\nconst ResponsiveChoropleth = props => (\n    <ResponsiveWrapper>\n        {({ width, height }) => <Choropleth width={width} height={height} {...props} />}\n    </ResponsiveWrapper>\n)\n\nexport default ResponsiveChoropleth\n","/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nimport { memo, useRef, useEffect, useCallback } from 'react'\nimport { geoContains } from 'd3-geo'\nimport { getRelativeCursor, withContainer, useDimensions, useTheme } from '@nivo/core'\nimport { renderLegendToCanvas } from '@nivo/legends'\nimport { useTooltip } from '@nivo/tooltip'\nimport { ChoroplethCanvasDefaultProps, ChoroplethCanvasPropTypes } from './props'\nimport { useGeoMap, useChoropleth } from './hooks'\n\nconst getFeatureFromMouseEvent = (event, el, features, projection) => {\n    const [x, y] = getRelativeCursor(el, event)\n\n    return features.find(f => geoContains(f, projection.invert([x, y])))\n}\n\nconst ChoroplethCanvas = memo(\n    ({\n        width,\n        height,\n        margin: partialMargin,\n        pixelRatio,\n        features,\n        data,\n        match,\n        label,\n        value,\n        valueFormat,\n        projectionType,\n        projectionScale,\n        projectionTranslation,\n        projectionRotation,\n        colors,\n        domain,\n        unknownColor,\n        borderWidth,\n        borderColor,\n        enableGraticule,\n        graticuleLineWidth,\n        graticuleLineColor,\n        layers,\n        legends,\n        isInteractive,\n        onClick,\n        onMouseMove,\n        tooltip: Tooltip,\n    }) => {\n        const canvasEl = useRef(null)\n        const theme = useTheme()\n        const { margin, outerWidth, outerHeight } = useDimensions(width, height, partialMargin)\n        const { projection, graticule, path, getBorderWidth, getBorderColor } = useGeoMap({\n            width,\n            height,\n            projectionType,\n            projectionScale,\n            projectionTranslation,\n            projectionRotation,\n            fillColor: () => {},\n            borderWidth,\n            borderColor,\n        })\n        const { getFillColor, boundFeatures, legendData } = useChoropleth({\n            features,\n            data,\n            match,\n            label,\n            value,\n            valueFormat,\n            colors,\n            unknownColor,\n            domain,\n        })\n\n        useEffect(() => {\n            if (!canvasEl) return\n\n            canvasEl.current.width = outerWidth * pixelRatio\n            canvasEl.current.height = outerHeight * pixelRatio\n\n            const ctx = canvasEl.current.getContext('2d')\n\n            ctx.scale(pixelRatio, pixelRatio)\n\n            ctx.fillStyle = theme.background\n            ctx.fillRect(0, 0, outerWidth, outerHeight)\n            ctx.translate(margin.left, margin.top)\n\n            path.context(ctx)\n\n            layers.forEach(layer => {\n                if (layer === 'graticule') {\n                    if (enableGraticule === true) {\n                        ctx.lineWidth = graticuleLineWidth\n                        ctx.strokeStyle = graticuleLineColor\n                        ctx.beginPath()\n                        path(graticule())\n                        ctx.stroke()\n                    }\n                } else if (layer === 'features') {\n                    boundFeatures.forEach(feature => {\n                        ctx.beginPath()\n                        path(feature)\n                        ctx.fillStyle = getFillColor(feature)\n                        ctx.fill()\n\n                        const borderWidth = getBorderWidth(feature)\n                        if (borderWidth > 0) {\n                            ctx.strokeStyle = getBorderColor(feature)\n                            ctx.lineWidth = borderWidth\n                            ctx.stroke()\n                        }\n                    })\n                } else if (layer === 'legends') {\n                    legends.forEach(legend => {\n                        renderLegendToCanvas(ctx, {\n                            ...legend,\n                            data: legendData,\n                            containerWidth: width,\n                            containerHeight: height,\n                            theme,\n                        })\n                    })\n                } else {\n                    // layer(ctx, {})\n                }\n            })\n        }, [\n            canvasEl,\n            outerWidth,\n            outerHeight,\n            margin,\n            pixelRatio,\n            theme,\n            path,\n            graticule,\n            getFillColor,\n            getBorderWidth,\n            getBorderColor,\n            boundFeatures,\n            legends,\n            layers,\n        ])\n\n        const { showTooltipFromEvent, hideTooltip } = useTooltip()\n        const handleMouseMove = useCallback(\n            event => {\n                if (!isInteractive || !Tooltip) return\n\n                const feature = getFeatureFromMouseEvent(\n                    event,\n                    canvasEl.current,\n                    boundFeatures,\n                    projection\n                )\n                if (feature) {\n                    showTooltipFromEvent(<Tooltip feature={feature} />, event)\n                } else {\n                    hideTooltip()\n                }\n                onMouseMove && onMouseMove(feature || null, event)\n            },\n            [\n                showTooltipFromEvent,\n                hideTooltip,\n                isInteractive,\n                Tooltip,\n                canvasEl,\n                boundFeatures,\n                projection,\n            ]\n        )\n        const handleMouseLeave = useCallback(\n            () => isInteractive && hideTooltip(),\n            [isInteractive, hideTooltip]\n        )\n        const handleClick = useCallback(\n            event => {\n                if (!isInteractive || !onClick) return\n\n                const feature = getFeatureFromMouseEvent(\n                    event,\n                    canvasEl.current,\n                    boundFeatures,\n                    projection\n                )\n                if (feature) {\n                    onClick(feature, event)\n                }\n            },\n            [isInteractive, canvasEl, boundFeatures, projection, onClick]\n        )\n\n        return (\n            <canvas\n                ref={canvasEl}\n                width={outerWidth * pixelRatio}\n                height={outerHeight * pixelRatio}\n                style={{\n                    width: outerWidth,\n                    height: outerHeight,\n                    cursor: isInteractive ? 'auto' : 'normal',\n                }}\n                onMouseMove={handleMouseMove}\n                onMouseLeave={handleMouseLeave}\n                onClick={handleClick}\n            />\n        )\n    }\n)\n\nChoroplethCanvas.displayName = 'ChoroplethCanvas'\nChoroplethCanvas.propTypes = ChoroplethCanvasPropTypes\nChoroplethCanvas.defaultProps = ChoroplethCanvasDefaultProps\n\nexport default withContainer(ChoroplethCanvas)\n","/*\n * This file is part of the nivo project.\n *\n * Copyright 2016-present, Raphaël Benitte.\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\nimport { ResponsiveWrapper } from '@nivo/core'\nimport ChoroplethCanvas from './ChoroplethCanvas'\n\nconst ResponsiveChoroplethCanvas = props => (\n    <ResponsiveWrapper>\n        {({ width, height }) => <ChoroplethCanvas width={width} height={height} {...props} />}\n    </ResponsiveWrapper>\n)\n\nexport default ResponsiveChoroplethCanvas\n"],"names":["projectionById","azimuthalEqualArea","geoAzimuthalEqualArea","azimuthalEquidistant","geoAzimuthalEquidistant","gnomonic","geoGnomonic","orthographic","geoOrthographic","stereographic","geoStereographic","equalEarth","geoEqualEarth","equirectangular","geoEquirectangular","mercator","geoMercator","transverseMercator","geoTransverseMercator","naturalEarth1","geoNaturalEarth1","useGeoMap","width","height","projectionType","projectionScale","projectionTranslation","projectionRotation","fillColor","borderWidth","borderColor","projection","useMemo","scale","translate","rotate","path","geoPath","graticule","geoGraticule","theme","useTheme","getBorderWidth","getBorderColor","useInheritedColor","getFillColor","useChoropleth","features","data","match","label","value","valueFormat","colors","unknownColor","domain","findMatchingDatum","_isFunction","feature","datum","featureKey","_get","datumKey","getLabel","getValue","valueFormatter","undefined","d","format","colorScale","guessQuantizeColorScale","boundFeatures","map","find","datumValue","featureWithData","formattedValue","color","legendData","useQuantizeColorScaleLegendData","ChoroplethTooltip","memo","_jsx","BasicTooltip","id","enableChip","propTypes","PropTypes","object","isRequired","displayName","commonPropTypes","arrayOf","shape","string","type","oneOf","properties","geometry","Object","keys","number","oneOfType","func","inheritedColorPropType","enableGraticule","bool","graticuleLineWidth","graticuleLineColor","isInteractive","onMouseEnter","onMouseMove","onMouseLeave","onClick","tooltip","any","layers","GeoMapPropTypes","role","GeoMapCanvasPropTypes","pixelRatio","commonChoroplethPropTypes","quantizeColorScalePropType","ChoroplethPropTypes","ChoroplethCanvasPropTypes","commonDefaultProps","legends","fill","defs","GeoMapDefaultProps","GeoMapCanvasDefaultProps","window","devicePixelRatio","commonChoroplethDefaultProps","ChoroplethDefaultProps","ChoroplethCanvasDefaultProps","GeoGraticule","lineWidth","lineColor","strokeWidth","stroke","GeoMapFeature","strokeLinejoin","event","GeoMap","props","partialMargin","margin","Tooltip","useDimensions","outerWidth","outerHeight","useTooltip","showTooltipFromEvent","hideTooltip","handleClick","useCallback","handleMouseEnter","handleMouseMove","handleMouseLeave","SvgWrapper","layer","i","Fragment","defaultProps","withContainer","ResponsiveGeoMap","ResponsiveWrapper","getFeatureFromMouseEvent","el","getRelativeCursor","x","y","f","geoContains","invert","GeoMapCanvas","canvasEl","useRef","useEffect","current","ctx","getContext","fillStyle","background","fillRect","left","top","context","forEach","strokeStyle","beginPath","ref","style","cursor","displatName","ResponsiveGeoMapCanvas","Choropleth","boundDefs","bindDefs","dataKey","targetKey","legend","BoxLegendSvg","containerWidth","containerHeight","ResponsiveChoropleth","ChoroplethCanvas","renderLegendToCanvas","ResponsiveChoroplethCanvas"],"mappings":"wsCA6BaA,EAAiB,CAC1BC,mBAAoBC,EACpBC,qBAAsBC,EACtBC,SAAUC,EACVC,aAAcC,EACdC,cAAeC,EACfC,WAAYC,EACZC,gBAAiBC,EACjBC,SAAUC,EACVC,mBAAoBC,EACpBC,cAAeC,GAGNC,EAAY,gBACrBC,IAAAA,MACAC,IAAAA,OACAC,IAAAA,eACAC,IAAAA,gBACAC,IAAAA,sBACAC,IAAAA,mBACAC,IAAAA,UACAC,IAAAA,YACAC,IAAAA,YAEMC,EAAaC,GAAQ,kBAChBhC,EAAewB,KACjBS,MAAMR,GACNS,UAAU,CAACZ,EAAQI,EAAsB,GAAIH,EAASG,EAAsB,KAC5ES,OAAOR,KACb,CACCL,EACAC,EACAC,EACAC,EACAC,EAAsB,GACtBA,EAAsB,GACtBC,EAAmB,GACnBA,EAAmB,GACnBA,EAAmB,KAEjBS,EAAOJ,GAAQ,kBAAMK,EAAQN,KAAa,CAACA,IAC3CO,EAAYN,GAAQ,kBAAMO,OAE1BC,EAAQC,IACRC,EAAiBV,GACnB,iBAA8B,mBAAhBH,EAA6BA,EAAc,kBAAMA,KAC/D,CAACA,IAECc,EAAiBC,EAAkBd,EAAaU,GAChDK,EAAeb,GACjB,iBAA4B,mBAAdJ,EAA2BA,EAAY,kBAAMA,KAC3D,CAACA,UAGE,CACHG,WAAAA,EACAK,KAAAA,EACAE,UAAAA,EACAI,eAAAA,EACAC,eAAAA,EACAE,aAAAA,IAIKC,EAAgB,gBACzBC,IAAAA,SACAC,IAAAA,KACAC,IAAAA,MACAC,IAAAA,MACAC,IAAAA,MACAC,IAAAA,YACAC,IAAAA,OACAC,IAAAA,aACAC,IAAAA,OAEMC,EAAoBxB,GAAQ,kBAC1ByB,EAAWR,GAAeA,EACvB,SAACS,EAASC,OACPC,EAAaC,EAAIH,EAAST,GAC1Ba,EAAWD,EAAIF,EAAOV,UAErBW,GAAcA,IAAeE,KAEzC,CAACb,IACEc,EAAW/B,GACb,kBAAOyB,EAAWP,GAASA,EAAQ,SAAAS,UAASE,EAAIF,EAAOT,MACvD,CAACA,IAECc,EAAWhC,GACb,kBAAOyB,EAAWN,GAASA,EAAQ,SAAAQ,UAASE,EAAIF,EAAOR,MACvD,CAACA,IAECc,EAAiBjC,GAAQ,uBACPkC,IAAhBd,EAAkC,SAAAe,UAAKA,GACvCV,EAAWL,GAAqBA,EAC7BgB,EAAOhB,KACf,CAACA,IAEEiB,EAAarC,GACf,kBAAMsC,EAAwBjB,GAAQE,OAAOA,KAC7C,CAACF,EAAQE,IAEPV,EAAeb,GAAQ,kBAClB,SAAA0B,eACmBQ,IAAlBR,EAAQP,MAA4BG,EACjCe,EAAWX,EAAQP,UAE/B,CAACkB,EAAYf,IAEViB,EAAgBvC,GAClB,kBACIe,EAASyB,KAAI,SAAAd,OACHC,EAAQX,EAAKyB,MAAK,SAAAd,UAASH,EAAkBE,EAASC,MACtDe,EAAaV,EAASL,MAExBA,EAAO,KACDgB,OACCjB,GACHV,KAAMW,EACNR,MAAOuB,EACPE,eAAgBX,EAAeS,YAEnCC,EAAgBE,MAAQhC,EAAa8B,GACrCA,EAAgBzB,MAAQa,EAASY,GAE1BA,SAGJjB,OAEf,CAACX,EAAUC,EAAMQ,EAAmBQ,EAAUC,EAAgBpB,IAG5DiC,EAAaC,EAAgC,CAC/C9C,MAAOoC,EACPjB,YAAaa,UAGV,CACHI,WAAAA,EACAxB,aAAAA,EACA0B,cAAAA,EACAN,eAAAA,EACAa,WAAAA,IChKFE,EAAoBC,GAAK,gBAAGvB,IAAAA,oBACTQ,IAAjBR,EAAQV,KAA2B,KAGnCkC,EAACC,GACGC,GAAI1B,EAAQR,MACZ2B,MAAOnB,EAAQmB,MACfQ,YAAY,EACZlC,MAAOO,EAAQkB,oBAK3BI,EAAkBM,UAAY,CAC1B5B,QAAS6B,EAAUC,OAAOC,YAG9BT,EAAkBU,YAAc,oBCfhC,IAAMC,EAAkB,CACpB5C,SAAUwC,EAAUK,QAChBL,EAAUM,MAAM,CACZT,GAAIG,EAAUO,OAAOL,WACrBM,KAAMR,EAAUS,MAAM,CAAC,YAAYP,WACnCQ,WAAYV,EAAUC,OACtBU,SAAUX,EAAUC,OAAOC,cAEjCA,WAEFjE,eAAgB+D,EAAUS,MAAMG,OAAOC,KAAKpG,IAAiByF,WAC7DhE,gBAAiB8D,EAAUc,OAAOZ,WAClC/D,sBAAuB6D,EAAUK,QAAQL,EAAUc,QAAQZ,WAC3D9D,mBAAoB4D,EAAUK,QAAQL,EAAUc,QAAQZ,WAExD7D,UAAW2D,EAAUe,UAAU,CAACf,EAAUO,OAAQP,EAAUgB,OAAOd,WACnE5D,YAAa0D,EAAUe,UAAU,CAACf,EAAUc,OAAQd,EAAUgB,OAAOd,WACrE3D,YAAa0E,EAAuBf,WAEpCgB,gBAAiBlB,EAAUmB,KAAKjB,WAChCkB,mBAAoBpB,EAAUc,OAAOZ,WACrCmB,mBAAoBrB,EAAUO,OAAOL,WAErCoB,cAAetB,EAAUmB,KAAKjB,WAC9BqB,aAAcvB,EAAUgB,KAAKd,WAC7BsB,YAAaxB,EAAUgB,KAAKd,WAC5BuB,aAAczB,EAAUgB,KAAKd,WAC7BwB,QAAS1B,EAAUgB,KAAKd,WACxByB,QAAS3B,EAAU4B,IAEnBC,OAAQ7B,EAAUK,QACdL,EAAUe,UAAU,CAACf,EAAUS,MAAM,CAAC,YAAa,aAAcT,EAAUgB,QAC7Ed,YAGO4B,OACN1B,GACH2B,KAAM/B,EAAUO,OAAOL,aAGd8B,KACTC,WAAYjC,EAAUc,OAAOZ,YAC1BE,GAGD8B,EAA4B,CAC9BzE,KAAMuC,EAAUK,QAAQL,EAAUC,QAAQC,WAC1CxC,MAAOsC,EAAUe,UAAU,CAACf,EAAUO,OAAQP,EAAUgB,OAAOd,WAC/DvC,MAAOqC,EAAUe,UAAU,CAACf,EAAUO,OAAQP,EAAUgB,OAAOd,WAC/DtC,MAAOoC,EAAUe,UAAU,CAACf,EAAUO,OAAQP,EAAUgB,OAAOd,WAC/DrC,YAAamC,EAAUe,UAAU,CAACf,EAAUO,OAAQP,EAAUgB,OAC9DlD,OAAQqE,EAA2BjC,WACnClC,OAAQgC,EAAUK,QAAQL,EAAUc,QAAQZ,WAC5CnC,aAAciC,EAAUO,OAAOL,WAC/B2B,OAAQ7B,EAAUK,QACdL,EAAUe,UAAU,CAACf,EAAUS,MAAM,CAAC,YAAa,WAAY,YAAaT,EAAUgB,QACxFd,YAGOkC,OACNN,EACAI,GACHH,KAAM/B,EAAUO,OAAOL,aAGdmC,OACNL,EACAE,GAGDI,EAAqB,CACvBrG,eAAgB,WAChBC,gBAAiB,IACjBC,sBAAuB,CAAC,GAAK,IAC7BC,mBAAoB,CAAC,EAAG,EAAG,GAE3B8E,iBAAiB,EACjBE,mBAAoB,GACpBC,mBAAoB,UAEpBhF,UAAW,UACXC,YAAa,EACbC,YAAa,UAEb+E,eAAe,EACfC,aAAc,aACdE,aAAc,aACdD,YAAa,aACbE,QAAS,aAETG,OAAQ,CAAC,YAAa,YACtBU,QAAS,GAETC,KAAM,GACNC,KAAM,IAGGC,OACNJ,GACHP,KAAM,QAGGY,OACNL,GACHL,WAA8B,oBAAXW,QAAyBA,OAAOC,kBAAwB,IAGzEC,GAA+B,CACjCpF,MAAO,KACPC,MAAO,KACPC,MAAO,QACPE,OAAQ,SACRC,aAAc,OACd4D,QAASlC,EACToC,OAAQ,CAAC,YAAa,WAAY,YAGzBkB,QACNL,EACAI,IACHf,KAAM,QAGGiB,QACNL,EACAG,IChIDG,GAAevD,GAAK,gBAAG7C,IAAAA,KAAME,IAAAA,UAAWmG,IAAAA,UAAWC,IAAAA,iBAC9CxD,UAAM6C,KAAK,OAAOY,YAAaF,EAAWG,OAAQF,EAAWvE,EAAG/B,EAAKE,UAGhFkG,GAAalD,UAAY,CACrBlD,KAAMmD,EAAUgB,KAAKd,WACrBnD,UAAWiD,EAAUgB,KAAKd,WAC1BgD,UAAWlD,EAAUc,OAAOZ,WAC5BiD,UAAWnD,EAAUO,OAAOL,YAGhC+C,GAAa9C,YAAc,eCX3B,IAAMmD,GAAgB5D,GAClB,kBACIvB,IAAAA,QACAtB,IAAAA,KACAR,IAAAA,UACAC,IAAAA,YACAC,IAAAA,YACAmF,IAAAA,QACAH,IAAAA,aACAC,IAAAA,YACAC,IAAAA,oBAGI9B,UAEI6C,oBAAMrE,SAAAA,EAASqE,QAAQnG,EACvB+G,YAAa9G,EACb+G,OAAQ9G,EACRgH,eAAe,QACf3E,EAAG/B,EAAKsB,GACRoD,aAAc,SAAAiC,UAASjC,EAAapD,EAASqF,IAC7ChC,YAAa,SAAAgC,UAAShC,EAAYrD,EAASqF,IAC3C/B,aAAc,SAAA+B,UAAS/B,EAAatD,EAASqF,IAC7C9B,QAAS,SAAA8B,UAAS9B,EAAQvD,EAASqF,KAT9BrF,EAAQ0B,OAe7ByD,GAAcvD,UAAY,CACtB5B,QAAS6B,EAAUM,MAAM,CACrBT,GAAIG,EAAUO,OAAOL,WACrBM,KAAMR,EAAUS,MAAM,CAAC,YAAYP,WACnCQ,WAAYV,EAAUC,OACtBU,SAAUX,EAAUC,OAAOC,aAC5BA,WACHrD,KAAMmD,EAAUgB,KAAKd,WAErB7D,UAAW2D,EAAUO,OAAOL,WAC5B5D,YAAa0D,EAAUc,OAAOZ,WAC9B3D,YAAayD,EAAUO,OAAOL,WAE9BqB,aAAcvB,EAAUgB,KAAKd,WAC7BsB,YAAaxB,EAAUgB,KAAKd,WAC5BuB,aAAczB,EAAUgB,KAAKd,WAC7BwB,QAAS1B,EAAUgB,KAAKd,YAG5BoD,GAAcnD,YAAc,gBC3C5B,IAAMsD,GAAS/D,GAAK,SAAAgE,OAEZ3H,EAmBA2H,EAnBA3H,MACAC,EAkBA0H,EAlBA1H,OACQ2H,EAiBRD,EAjBAE,OACApG,EAgBAkG,EAhBAlG,SACAqE,EAeA6B,EAfA7B,OACA5F,EAcAyH,EAdAzH,eACAC,EAaAwH,EAbAxH,gBACAC,EAYAuH,EAZAvH,sBACAC,EAWAsH,EAXAtH,mBACAC,EAUAqH,EAVArH,UACAC,EASAoH,EATApH,YACAC,EAQAmH,EARAnH,YACA2E,EAOAwC,EAPAxC,gBACAE,EAMAsC,EANAtC,mBACAC,EAKAqC,EALArC,mBACAC,EAIAoC,EAJApC,cACAI,EAGAgC,EAHAhC,QACSmC,EAETH,EAFA/B,QACAI,EACA2B,EADA3B,OAEwC+B,EAAc/H,EAAOC,EAAQ2H,GAAjEC,IAAAA,OAAQG,IAAAA,WAAYC,IAAAA,cAC8ClI,EAAU,CAChFC,MAAAA,EACAC,OAAAA,EACAC,eAAAA,EACAC,gBAAAA,EACAC,sBAAAA,EACAC,mBAAAA,EACAC,UAAAA,EACAC,YAAAA,EACAC,YAAAA,IATIQ,IAAAA,UAAWF,IAAAA,KAAMS,IAAAA,aAAcH,IAAAA,eAAgBC,IAAAA,eAYjDH,EAAQC,MAEgC+G,IAAtCC,IAAAA,qBAAsBC,IAAAA,YACxBC,EAAcC,GAChB,SAAClG,EAASqF,UAAUlC,GAAiBI,GAAWA,EAAQvD,EAASqF,KACjE,CAAClC,EAAeI,IAEd4C,EAAmBD,GACrB,SAAClG,EAASqF,UACNlC,GAAiBuC,GAAWK,EAAqBvE,EAACkE,GAAQ1F,QAASA,IAAaqF,KACpF,CAAClC,EAAe4C,EAAsBL,IAEpCU,EAAkBF,GACpB,SAAClG,EAASqF,UACNlC,GAAiBuC,GAAWK,EAAqBvE,EAACkE,GAAQ1F,QAASA,IAAaqF,KACpF,CAAClC,EAAe4C,EAAsBL,IAEpCW,EAAmBH,GACrB,kBAAM/C,GAAiB6C,MACvB,CAAC7C,EAAe6C,WAIhBxE,EAAC8E,GACG1I,MAAOgI,EACP/H,OAAQgI,EACRJ,OAAQA,EACR3G,MAAOA,EACP8E,KAAMA,WAELF,EAAO5C,KAAI,SAACyF,EAAOC,SACF,cAAVD,GACwB,IAApBxD,EAAiC,KAGjCvB,EAACsD,IAEGpG,KAAMA,EACNE,UAAWA,EACXmG,UAAW9B,EACX+B,UAAW9B,GAJP,aAQF,aAAVqD,EAEI/E,EAACiF,YACIpH,EAASyB,KAAI,SAAAd,UACVwB,EAAC2D,IAEGnF,QAASA,EACTtB,KAAMA,EACNR,UAAWiB,EAAaa,GACxB7B,YAAaa,EAAegB,GAC5B5B,YAAaa,EAAee,GAC5BoD,aAAc+C,EACd9C,YAAa+C,EACb9C,aAAc+C,EACd9C,QAAS0C,GATJjG,EAAQ0B,QAHX,YAmBfF,EAACiF,YAAkBF,EAAMhB,IAAViB,WAMtClB,GAAOtD,YAAc,SACrBsD,GAAO1D,UAAY+B,EACnB2B,GAAOoB,aAAenC,EAEtB,OAAeoC,EAAcrB,ICnHvBsB,GAAmB,SAAArB,UACrB/D,EAACqF,YACI,gBAAGjJ,IAAAA,MAAOC,IAAAA,cAAa2D,EAAC8D,MAAO1H,MAAOA,EAAOC,OAAQA,GAAY0H,QCEpEuB,GAA2B,SAACzB,EAAO0B,EAAI1H,EAAUhB,SACpC2I,EAAkBD,EAAI1B,GAA9B4B,OAAGC,cAEH7H,EAAS0B,MAAK,SAAAoG,UAAKC,EAAYD,EAAG9I,EAAWgJ,OAAO,CAACJ,EAAGC,SAG7DI,GAAe/F,GAAK,SAAAgE,OAElB3H,EAwBA2H,EAxBA3H,MACAC,EAuBA0H,EAvBA1H,OACQ2H,EAsBRD,EAtBAE,OACA3B,EAqBAyB,EArBAzB,WACAzE,EAoBAkG,EApBAlG,SACAqE,EAmBA6B,EAnBA7B,OAEA5F,EAiBAyH,EAjBAzH,eACAC,EAgBAwH,EAhBAxH,gBACAC,EAeAuH,EAfAvH,sBACAC,EAcAsH,EAdAtH,mBAEAC,EAYAqH,EAZArH,UACAC,EAWAoH,EAXApH,YACAC,EAUAmH,EAVAnH,YAEA2E,EAQAwC,EARAxC,gBACAE,EAOAsC,EAPAtC,mBACAC,EAMAqC,EANArC,mBAEAC,EAIAoC,EAJApC,cACAI,EAGAgC,EAHAhC,QACAF,EAEAkC,EAFAlC,YACSqC,EACTH,EADA/B,QAGE+D,EAAWC,EAAO,MAClB1I,EAAQC,MAC8B4G,EAAc/H,EAAOC,EAAQ2H,GAAjEC,IAAAA,OAAQG,IAAAA,WAAYC,IAAAA,cAC0DlI,EAClF,CACIC,MAAAA,EACAC,OAAAA,EACAC,eAAAA,EACAC,gBAAAA,EACAC,sBAAAA,EACAC,mBAAAA,EACAC,UAAAA,EACAC,YAAAA,EACAC,YAAAA,IAVAC,IAAAA,WAAYO,IAAAA,UAAWF,IAAAA,KAAMS,IAAAA,aAAcH,IAAAA,eAAgBC,IAAAA,eAcnEwI,GAAU,cACDF,GAELA,EAASG,QAAQ9J,MAAQgI,EAAa9B,EACtCyD,EAASG,QAAQ7J,OAASgI,EAAc/B,MAElC6D,EAAMJ,EAASG,QAAQE,WAAW,MAExCD,EAAIpJ,MAAMuF,EAAYA,GAEtB6D,EAAIE,UAAY/I,EAAMgJ,WACtBH,EAAII,SAAS,EAAG,EAAGnC,EAAYC,GAC/B8B,EAAInJ,UAAUiH,EAAOuC,KAAMvC,EAAOwC,KAElCvJ,EAAKwJ,QAAQP,GAEbjE,EAAOyE,SAAQ,SAAA5B,GACG,cAAVA,GACwB,IAApBxD,IACA4E,EAAI5C,UAAY9B,EAChB0E,EAAIS,YAAclF,EAClByE,EAAIU,YACJ3J,EAAKE,KACL+I,EAAIzC,UAES,aAAVqB,EACPlH,EAAS8I,SAAQ,SAAAnI,GACb2H,EAAIU,YACJ3J,EAAKsB,GACL2H,EAAIE,UAAY1I,EAAaa,GAC7B2H,EAAItD,WAEElG,EAAca,EAAegB,GAC/B7B,EAAc,IACdwJ,EAAIS,YAAcnJ,EAAee,GACjC2H,EAAI5C,UAAY5G,EAChBwJ,EAAIzC,aAIZqB,EAAMoB,EAAKpC,SAGpB,CACCgC,EACA3B,EACAC,EACAJ,EACA3B,EACAhF,EACAJ,EACAE,EACAO,EACAH,EACAC,EACAI,EACAqE,UAG0CoC,IAAtCC,IAAAA,qBAAsBC,IAAAA,YACxBI,EAAkBF,GACpB,SAAAb,MACSlC,GAAkBuC,OAEjB1F,EAAU8G,GAAyBzB,EAAOkC,EAASG,QAASrI,EAAUhB,GACxE2B,EACA+F,EAAqBvE,EAACkE,GAAQ1F,QAASA,IAAaqF,GAEpDW,IAEJ3C,GAAeA,EAAYrD,GAAW,KAAMqF,MAEhD,CAACU,EAAsBC,EAAa7C,EAAeuC,EAAS6B,EAAUlI,EAAUhB,IAE9EgI,EAAmBH,GACrB,kBAAM/C,GAAiB6C,MACvB,CAAC7C,EAAe6C,IAEdC,EAAcC,GAChB,SAAAb,MACSlC,GAAkBI,OAEjBvD,EAAU8G,GAAyBzB,EAAOkC,EAASG,QAASrI,EAAUhB,GACxE2B,GACAuD,EAAQvD,EAASqF,MAGzB,CAAClC,EAAeoE,EAAUlI,EAAUhB,EAAYkF,WAIhD/B,YACI8G,IAAKf,EACL3J,MAAOgI,EAAa9B,EACpBjG,OAAQgI,EAAc/B,EACtByE,MAAO,CACH3K,MAAOgI,EACP/H,OAAQgI,EACR2C,OAAQrF,EAAgB,OAAS,UAErCE,YAAa+C,EACb9C,aAAc+C,EACd9C,QAAS0C,OAKrBqB,GAAamB,YAAc,eAC3BnB,GAAa1F,UAAYiC,EACzByD,GAAaZ,aAAelC,EAE5B,OAAemC,EAAcW,ICtKvBoB,GAAyB,SAAAnD,UAC3B/D,EAACqF,YACI,gBAAGjJ,IAAAA,MAAOC,IAAAA,cAAa2D,EAAC8F,MAAa1J,MAAOA,EAAOC,OAAQA,GAAY0H,QCI1EoD,GAAapH,GACf,gBACI3D,IAAAA,MACAC,IAAAA,OACQ2H,IAARC,OACApG,IAAAA,SACAC,IAAAA,KACAC,IAAAA,MACAC,IAAAA,MACAC,IAAAA,MACAC,IAAAA,YACA5B,IAAAA,eACAC,IAAAA,gBACAC,IAAAA,sBACAC,IAAAA,mBACA0B,IAAAA,OACAE,IAAAA,OACAD,IAAAA,aACAzB,IAAAA,YACAC,IAAAA,YACA2E,IAAAA,gBACAE,IAAAA,mBACAC,IAAAA,mBACAQ,IAAAA,OACAU,IAAAA,QACAjB,IAAAA,cACAI,IAAAA,QACSmC,IAATlC,QACAI,IAAAA,SACAU,KAAAA,aAAOM,GAAuBN,WAC9BD,KAAAA,aAAOO,GAAuBP,SAEcsB,EAAc/H,EAAOC,EAAQ2H,GAAjEC,IAAAA,OAAQG,IAAAA,WAAYC,IAAAA,cACgClI,EAAU,CAClEC,MAAAA,EACAC,OAAAA,EACAC,eAAAA,EACAC,gBAAAA,EACAC,sBAAAA,EACAC,mBAAAA,EACAC,UAAW,aACXC,YAAAA,EACAC,YAAAA,IATIQ,IAAAA,UAAWF,IAAAA,KAAMM,IAAAA,eAAgBC,IAAAA,iBAWWG,EAAc,CAC9DC,SAAAA,EACAC,KAAAA,EACAC,MAAAA,EACAC,MAAAA,EACAC,MAAAA,EACAC,YAAAA,EACAC,OAAAA,EACAC,aAAAA,EACAC,OAAAA,IATIV,KAAAA,aAAc0B,KAAAA,cAAeO,KAAAA,WAY/BtC,GAAQC,IAER6J,GAAYC,EAASvE,EAAMzD,GAAewD,EAAM,CAClDyE,QAAS,OACTC,UAAW,YAG+BjD,IAAtCC,MAAAA,qBAAsBC,MAAAA,YACxBC,GAAcC,GAChB,SAAClG,EAASqF,UAAUlC,GAAiBI,GAAWA,EAAQvD,EAASqF,KACjE,CAAClC,EAAeI,IAEd4C,GAAmBD,GACrB,SAAClG,EAASqF,UACNlC,GACAuC,GACAK,GAAqBvE,EAACkE,GAAQ1F,QAASA,IAAaqF,KACxD,CAAClC,EAAe4C,GAAsBL,IAEpCU,GAAkBF,GACpB,SAAClG,EAASqF,UACNlC,GACAuC,GACAK,GAAqBvE,EAACkE,GAAQ1F,QAASA,IAAaqF,KACxD,CAAClC,EAAe4C,GAAsBL,IAEpCW,GAAmBH,GACrB,kBAAM/C,GAAiB6C,OACvB,CAAC7C,EAAe6C,YAIhBxE,EAAC8E,GACG1I,MAAOgI,EACP/H,OAAQgI,EACRJ,OAAQA,EACR3G,MAAOA,GACPwF,KAAMsE,GACNhF,KAAMA,WAELF,EAAO5C,KAAI,SAACyF,EAAOC,SACF,cAAVD,GACwB,IAApBxD,EAAiC,KAGjCvB,EAACsD,IAEGpG,KAAMA,EACNE,UAAWA,EACXmG,UAAW9B,EACX+B,UAAW9B,GAJP,aAQF,aAAVqD,EAEI/E,EAACiF,YACI5F,GAAcC,KAAI,SAAAd,UACfwB,EAAC2D,IAEGnF,QAASA,EACTtB,KAAMA,EACNR,UAAWiB,GAAaa,GACxB7B,YAAaa,EAAegB,GAC5B5B,YAAaa,EAAee,GAC5BoD,aAAc+C,GACd9C,YAAa+C,GACb9C,aAAc+C,GACd9C,QAAS0C,IATJjG,EAAQ0B,QAHX,YAkBR,YAAV6E,EACOnC,EAAQtD,KAAI,SAACkI,EAAQxC,UAEpBhF,EAACyH,KAEGC,eAAgBtL,EAChBuL,gBAAiBtL,EACjByB,KAAM8B,IACF4H,GAJCxC,MAUdhF,EAACiF,YAAkBF,EAAM,KAAVC,WAO1CmC,GAAW3G,YAAc,aACzB2G,GAAW/G,UAAYqC,EACvB0E,GAAWjC,aAAe9B,GAE1B,OAAe+B,EAAcgC,ICjKvBS,GAAuB,SAAA7D,UACzB/D,EAACqF,YACI,gBAAGjJ,IAAAA,MAAOC,IAAAA,cAAa2D,EAACmH,MAAW/K,MAAOA,EAAOC,OAAQA,GAAY0H,QCGxEuB,GAA2B,SAACzB,EAAO0B,EAAI1H,EAAUhB,SACpC2I,EAAkBD,EAAI1B,GAA9B4B,OAAGC,cAEH7H,EAAS0B,MAAK,SAAAoG,UAAKC,EAAYD,EAAG9I,EAAWgJ,OAAO,CAACJ,EAAGC,SAG7DmC,GAAmB9H,GACrB,gBACI3D,IAAAA,MACAC,IAAAA,OACQ2H,IAARC,OACA3B,IAAAA,WACAzE,IAAAA,SACAC,IAAAA,KACAC,IAAAA,MACAC,IAAAA,MACAC,IAAAA,MACAC,IAAAA,YACA5B,IAAAA,eACAC,IAAAA,gBACAC,IAAAA,sBACAC,IAAAA,mBACA0B,IAAAA,OACAE,IAAAA,OACAD,IAAAA,aACAzB,IAAAA,YACAC,IAAAA,YACA2E,IAAAA,gBACAE,IAAAA,mBACAC,IAAAA,mBACAQ,IAAAA,OACAU,IAAAA,QACAjB,IAAAA,cACAI,IAAAA,QACAF,IAAAA,YACSqC,IAATlC,QAEM+D,EAAWC,EAAO,MAClB1I,EAAQC,MAC8B4G,EAAc/H,EAAOC,EAAQ2H,GAAjEC,IAAAA,OAAQG,IAAAA,WAAYC,IAAAA,cAC4ClI,EAAU,CAC9EC,MAAAA,EACAC,OAAAA,EACAC,eAAAA,EACAC,gBAAAA,EACAC,sBAAAA,EACAC,mBAAAA,EACAC,UAAW,aACXC,YAAAA,EACAC,YAAAA,IATIC,IAAAA,WAAYO,IAAAA,UAAWF,IAAAA,KAAMM,IAAAA,eAAgBC,IAAAA,iBAWDG,EAAc,CAC9DC,SAAAA,EACAC,KAAAA,EACAC,MAAAA,EACAC,MAAAA,EACAC,MAAAA,EACAC,YAAAA,EACAC,OAAAA,EACAC,aAAAA,EACAC,OAAAA,IATIV,IAAAA,aAAc0B,KAAAA,cAAeO,KAAAA,WAYrCqG,GAAU,cACDF,GAELA,EAASG,QAAQ9J,MAAQgI,EAAa9B,EACtCyD,EAASG,QAAQ7J,OAASgI,EAAc/B,MAElC6D,EAAMJ,EAASG,QAAQE,WAAW,MAExCD,EAAIpJ,MAAMuF,EAAYA,GAEtB6D,EAAIE,UAAY/I,EAAMgJ,WACtBH,EAAII,SAAS,EAAG,EAAGnC,EAAYC,GAC/B8B,EAAInJ,UAAUiH,EAAOuC,KAAMvC,EAAOwC,KAElCvJ,EAAKwJ,QAAQP,GAEbjE,EAAOyE,SAAQ,SAAA5B,GACG,cAAVA,GACwB,IAApBxD,IACA4E,EAAI5C,UAAY9B,EAChB0E,EAAIS,YAAclF,EAClByE,EAAIU,YACJ3J,EAAKE,KACL+I,EAAIzC,UAES,aAAVqB,EACP1F,GAAcsH,SAAQ,SAAAnI,GAClB2H,EAAIU,YACJ3J,EAAKsB,GACL2H,EAAIE,UAAY1I,EAAaa,GAC7B2H,EAAItD,WAEElG,EAAca,EAAegB,GAC/B7B,EAAc,IACdwJ,EAAIS,YAAcnJ,EAAee,GACjC2H,EAAI5C,UAAY5G,EAChBwJ,EAAIzC,aAGK,YAAVqB,GACPnC,EAAQ+D,SAAQ,SAAAa,GACZM,EAAqB3B,OACdqB,GACH1J,KAAM8B,GACN8H,eAAgBtL,EAChBuL,gBAAiBtL,EACjBiB,MAAAA,cAOjB,CACCyI,EACA3B,EACAC,EACAJ,EACA3B,EACAhF,EACAJ,EACAE,EACAO,EACAH,EACAC,EACA4B,GACAuD,EACAV,WAG0CoC,IAAtCC,MAAAA,qBAAsBC,MAAAA,YACxBI,GAAkBF,GACpB,SAAAb,MACSlC,GAAkBuC,OAEjB1F,EAAU8G,GACZzB,EACAkC,EAASG,QACT7G,GACAxC,GAEA2B,EACA+F,GAAqBvE,EAACkE,GAAQ1F,QAASA,IAAaqF,GAEpDW,KAEJ3C,GAAeA,EAAYrD,GAAW,KAAMqF,MAEhD,CACIU,GACAC,GACA7C,EACAuC,EACA6B,EACA1G,GACAxC,IAGFgI,GAAmBH,GACrB,kBAAM/C,GAAiB6C,OACvB,CAAC7C,EAAe6C,KAEdC,GAAcC,GAChB,SAAAb,MACSlC,GAAkBI,OAEjBvD,EAAU8G,GACZzB,EACAkC,EAASG,QACT7G,GACAxC,GAEA2B,GACAuD,EAAQvD,EAASqF,MAGzB,CAAClC,EAAeoE,EAAU1G,GAAexC,EAAYkF,WAIrD/B,YACI8G,IAAKf,EACL3J,MAAOgI,EAAa9B,EACpBjG,OAAQgI,EAAc/B,EACtByE,MAAO,CACH3K,MAAOgI,EACP/H,OAAQgI,EACR2C,OAAQrF,EAAgB,OAAS,UAErCE,YAAa+C,GACb9C,aAAc+C,GACd9C,QAAS0C,QAMzBoD,GAAiBrH,YAAc,mBAC/BqH,GAAiBzH,UAAYsC,EAC7BmF,GAAiB3C,aAAe7B,GAEhC,OAAe8B,EAAc0C,ICjNvBE,GAA6B,SAAAhE,UAC/B/D,EAACqF,YACI,gBAAGjJ,IAAAA,MAAOC,IAAAA,cAAa2D,EAAC6H,MAAiBzL,MAAOA,EAAOC,OAAQA,GAAY0H"}